# 18. Check Our Docker Install and Config
- [docker version]
- [docker info]
- Used to be [docker run]
- Now is [docker container run] in [docker command + sub-command] form after the number of commands exploded and needed to become grouped
- New commands will not have short format; must be a sub-command of existing command

# 19. Starting a Nginx Web Server
- Image - binaries, libraries, source code,... that make up your application
- Container - running instance of Image as a process
- Registry - storage for container images (e.g. Docker Hub)
- [docker container run --publish 80:80 nginx]
- NOTE: For Windows, Ctrl-C exits foreground container process but leave it running in background
- [docker container run --publsih 80:80 --detach nginx]
-- returns unique container id
-- NOTE: For Windows, additional command to stop container: [docker stop <container id/name>]
- [docker container ls] OLD WAY: [docker ps]
- [docker container stop <first few digits of id>] OLD WAY: [docker stop <first few digits of id>] stops container but doesn't remove it
- [docker container ls] only shows running containers
- [docker container ls -a] shows stopped ones too
- [docker container run] ALWAYS starts new container
- [docker container start] starts an EXISTING stopped one
- *Container ID* is created for us and *Container Name* is as well if we don't specify (the latter, which will use adjectives and surnames of notable hackers or scientists)
- [docker container run --publish 80:80 --detach --name webhost nginx]
- [docker container logs webhost]
- [docker container top webhost] shows process running inside the container
- [docker container rm] OLDWAY: [docker rm] to delete one or more containers
-- [docker container rm 63f 690...]
-- but must first stop running containers OR force it: [docker container rm -f 63f]

# 20. Debrief: What Happens When We Run a Container
## What happens in 'docker container run'
- pulls image down from remote image repository (default is Docker Hub), if image is not found in local image cache
- pulls download latest image version if version not specified
- creates new container based on image by putting layers of changes over it
- gives container virtual IP address on network inside docker engine
- opens up port if specified with [--publish]; otherwise does not open ports at all
- container starts with command specified in the Dockerfile
- can also set default command when it starts container
[docker container run --publish 8080:80 --name webhost -d nginx:1:11 nginx -T]

# 21. Container VS. VM: It's Just a Process
- Containers are just a [process] running on host OS
- https://www.bretfisher.com/docker-for-mac-commands-for-getting-into-local-docker-vm/
-- [docker run -it --rm --privileged --pid=host justincormack/nsenter1]
-- [docker run -it --rm --privileged --pid=host mongo]
-- connect to tty on Docker for Mac VM
[screen ~/Library/Containers/com.docker.docker/Data/vms/0/tty]
-- disconnect that session but leave it open in background
[Ctrl-a d]
-- list that session that's still running in background
[screen -ls]
-- reconnect to that session (don't open a new one, that won't work and 2nd tty will give you garbled screen)
[screen -r]
-- kill this session (window) and exit
[Ctrl-a k]
- Find running process with [ps aux | grep mongodb]
- Stop it with [docker container stop mongo]
- Start it with [docker container start mongo]

[[Resources]]
https://www.bretfisher.com/docker-for-mac-commands-for-getting-into-local-docker-vm/
https://www.bretfisher.com/getting-a-shell-in-the-docker-for-windows-vm/
https://github.com/mikegcoleman/docker101/blob/master/Docker_eBook_Jan_2017.pdf
https://www.youtube.com/watch?v=sK5i-N34im8&feature=youtu.be&list=PLBmVKD7o3L8v7Kl_XXh3KaJl9Qw2lyuFl


# 22. Windows Containers: Docker Is No Longer Just Linux
Windows Containers and Docker: 101
https://www.youtube.com/watch?v=066-9yw8-7c
- 7:00 minutes for starting container and commands within it
- [docker un -it sixeyed/print-env powershell]
- [docker run -it sixeyed/print-env ping -n 100 192.168.2.150]
Versus
- [docker run -it sixeyed/print-env]
- [docker run -d sixeyed/print-env]
- [docker inspect] allows viewing of IP address of container needed to connect to container service running on Windows host if you're logged on locally to it
- in 2017, could only run Win containers on Win, Linux on Linux, but can combine them into one Docker Swarm used as a cross-platform compute cluster
- Twitter Docker Captains: https://is.gd/7nU0if
- Getting Started Docs: Docker https://is.gd/5WrZLC, MSDN https://is.gd/Qnd2LD
- @EltonStoneman https://is.gd/jEUW1r

Beyond \ - the path to Windows and Linux parity in Docker
https://www.youtube.com/watch?v=4ZY_4OeyJsw
"-Bringing Docker to Windows has been an awesome project - while at times challenging or frustrating the overwhelming majority of the times itâ€™s just been fun.  This talk will focus on the work it took to bring Windows and Docker together, some of the areas where gaps remain between the Windows and Linux platform (specific to Docker) and the roadmap towards convergence.  We will discuss some of the tradeoffs and choices we made as well as some of the lessons we took from the Linux ecosystem and how we applied them as we built out Windows support."

Docker + Microsoft - Investing in the Future of your Applications
https://www.youtube.com/watch?v=QASAqcuuzgI
"When you combine Docker's cross platform support of Linux and Windows containers and Microsoft cloud technologies, you get a supercharged portfolio that can support virtually every enterprise workload. Whether you host your workloads in private datacenters, public cloud or hybrid we offer great end-to-end solutions or individual components from the developer's keyboard to cloud. Azure Container Service is the simplest way to deploy your container orchestration environment such as Docker Datacenter so your developers can deploy their apps more quickly. Windows Server Containers are powered by Docker Enterprise Edition. You use the same Docker tooling to build and run those containers as you do your Linux containers and with the tooling you choose - Eclipse, Visual Studio, Jenkins, Visual Studio Team Service. Microsoft + Docker empowers you, the developer to build cutting edge apps - quickly!"


# 23. Assignment: Manage Multiple Containers
- docs.docker.com and --help
- run a nginx, mysql, and https server
- run all of them with --detach or -d, name them with --name
- listen on different ports: nginx 80:80, httpd 8080:80, mysql 3306:3306
- container command option is [environment variable passing]
-- when running mysql, use [--env] to pass in [MYSQL_RANDOM_ROOT_PASSWORD=yes]
-- use the [docker container logs] command to find out what password will be
- when done, clean up with [docker container stop] and [docker container rm]

# 24. Assignment Answers: Manage Multiple Containers
## MY ANSWERS

[docker container run --publish 3306:3306 --detach --name mymysql --env MYSQL_RANDOM_ROOT_PASSWORD=yes mysql]

[docker container run --publish 8080:80 --detach --name myhttpd httpd]

[docker container run --publish 80:80 --detach --name mynginx nginx]

### used this command to find the generated random password:
[docker logs mymysql 2>/dev/null | grep "GENERATED"]

### confirmed web services good:
AirTight:udemy-docker-mastery twostudy$ curl host:8080
curl: (6) Could not resolve host: host
AirTight:udemy-docker-mastery twostudy$ curl localhost:8080
<html><body><h1>It works!</h1></body></html>

### stop then delete containers
docker container stop mymysql mynginx myhttpd
docker container rm mymysql myhttpd mynginx

## LESSON ANSWERS
- mostly the same
- hardest part was revealing the randomly generated mysql password that was not displayed in [docker inspect] and was instead found in the command above


# 25. What's Going On In Containers: CLI Process Monitoring
[docker container top] shows process list of what's running inside container
[docker container inspect] shows details on how container started and how it's configured with volumes, networking,... {{OLD WAY}}: [docker inspect]
[docker container stats] performance stats for all containers in a real-time stream {{OLD WAY}}: [docker stats]


# 26. Getting a Shell Inside Containers: No Need for SSH
# 27. Docker Networks: Concepts for Private and Public Comms in Containers
# 28. FIXME: Change In Official Nginx Image Removes Ping
# 29. Docker Networks: CLI Management of Virtual Networks
# 30. Docker Networks: DNS and How Containers Find Each Other
# 31. Assignment: Using Containers for CLI Testing
# 32. Assignment Answers: Using Containers for CLI Testing
# 33. FIXME: Bug in alpine affects nslookup
# 34. Assignment: DNS Round Robin Test
# 35. Assignment Answers: DNS Round Robin Test
